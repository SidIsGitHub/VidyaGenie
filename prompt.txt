<!DOCTYPE html>
<html lang="en">

<head>
Â  Â  <meta charset="UTF-8">
Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â  Â  <title>VidyaGenie</title>
Â  Â  <style>
Â  Â  Â  Â  /* --- VARIABLES & RESET --- */
Â  Â  Â  Â  * {
Â  Â  Â  Â  Â  Â  margin: 0;
Â  Â  Â  Â  Â  Â  padding: 0;
Â  Â  Â  Â  Â  Â  box-sizing: border-box;
Â  Â  Â  Â  }

Â  Â  Â  Â  :root {
Â  Â  Â  Â  Â  Â  --primary-color: #2196F3;
Â  Â  Â  Â  Â  Â  --secondary-color: #4CAF50;
Â  Â  Â  Â  Â  Â  --danger-color: #f44336;
Â  Â  Â  Â  Â  Â  --light-bg: #f5f5f5;
Â  Â  Â  Â  Â  Â  --text-color: #333;
Â  Â  Â  Â  Â  Â  --border-color: #ddd;
Â  Â  Â  Â  }

Â  Â  Â  Â  body {
Â  Â  Â  Â  Â  Â  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
Â  Â  Â  Â  Â  Â  background-color: var(--light-bg);
Â  Â  Â  Â  Â  Â  color: var(--text-color);
Â  Â  Â  Â  }

Â  Â  Â  Â  .container {
Â  Â  Â  Â  Â  Â  max-width: 1200px;
Â  Â  Â  Â  Â  Â  margin: 0 auto;
Â  Â  Â  Â  Â  Â  padding: 20px;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* --- NAVBAR --- */
Â  Â  Â  Â  .navbar {
Â  Â  Â  Â  Â  Â  background: var(--primary-color);
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  Â  Â  padding: 15px 20px;
Â  Â  Â  Â  Â  Â  margin-bottom: 20px;
Â  Â  Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  justify-content: space-between;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
Â  Â  Â  Â  }

Â  Â  Â  Â  .navbar-brand h1 {
Â  Â  Â  Â  Â  Â  font-size: 24px;
Â  Â  Â  Â  Â  Â  margin: 0;
Â  Â  Â  Â  }

Â  Â  Â  Â  .navbar-brand p {
Â  Â  Â  Â  Â  Â  font-size: 12px;
Â  Â  Â  Â  Â  Â  opacity: 0.9;
Â  Â  Â  Â  Â  Â  margin-top: 4px;
Â  Â  Â  Â  }

Â  Â  Â  Â  .navbar-right {
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  gap: 15px;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* --- ICONS --- */
Â  Â  Â  Â  .profile-circle,
Â  Â  Â  Â  .requests-icon-style {
Â  Â  Â  Â  Â  Â  width: 40px;
Â  Â  Â  Â  Â  Â  height: 40px;
Â  Â  Â  Â  Â  Â  background-color: white;
Â  Â  Â  Â  Â  Â  color: var(--primary-color);
Â  Â  Â  Â  Â  Â  border-radius: 50%;
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  justify-content: center;
Â  Â  Â  Â  Â  Â  font-weight: bold;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  border: 2px solid rgba(255, 255, 255, 0.5);
Â  Â  Â  Â  Â  Â  transition: all 0.2s ease;
Â  Â  Â  Â  Â  Â  user-select: none;
Â  Â  Â  Â  }

Â  Â  Â  Â  .requests-icon-style {
Â  Â  Â  Â  Â  Â  margin-right: 5px;
Â  Â  Â  Â  }

Â  Â  Â  Â  .profile-circle:hover,
Â  Â  Â  Â  .requests-icon-style:hover {
Â  Â  Â  Â  Â  Â  transform: scale(1.1);
Â  Â  Â  Â  Â  Â  box-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
Â  Â  Â  Â  }

Â  Â  Â  Â  /* --- TABS --- */
Â  Â  Â  Â  .tabs {
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  gap: 10px;
Â  Â  Â  Â  Â  Â  margin-bottom: 20px;
Â  Â  Â  Â  Â  Â  border-bottom: 2px solid var(--border-color);
Â  Â  Â  Â  Â  Â  justify-content: center;
Â  Â  Â  Â  }

Â  Â  Â  Â  .tab-button {
Â  Â  Â  Â  Â  Â  padding: 12px 20px;
Â  Â  Â  Â  Â  Â  background: none;
Â  Â  Â  Â  Â  Â  border: none;
Â  Â  Â  Â  Â  Â  border-bottom: 3px solid transparent;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  font-weight: 500;
Â  Â  Â  Â  Â  Â  color: #666;
Â  Â  Â  Â  }

Â  Â  Â  Â  .tab-button.active {
Â  Â  Â  Â  Â  Â  color: var(--primary-color);
Â  Â  Â  Â  Â  Â  border-bottom-color: var(--primary-color);
Â  Â  Â  Â  }

Â  Â  Â  Â  .tab-content {
Â  Â  Â  Â  Â  Â  display: none;
Â  Â  Â  Â  Â  Â  position: relative;
Â  Â  Â  Â  }

Â  Â  Â  Â  .tab-content.active {
Â  Â  Â  Â  Â  Â  display: block;
Â  Â  Â  Â  Â  Â  animation: fadeIn 0.3s;
Â  Â  Â  Â  }

Â  Â  Â  Â  @keyframes fadeIn {
Â  Â  Â  Â  Â  Â  from {
Â  Â  Â  Â  Â  Â  Â  Â  opacity: 0;
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  to {
Â  Â  Â  Â  Â  Â  Â  Â  opacity: 1;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  /* --- COMMUNITY + ICON --- */
Â  Â  Â  Â  .center-icon-wrapper {
Â  Â  Â  Â  Â  Â  padding: 10px 0;
Â  Â  Â  Â  Â  Â  margin: 10px 0;
Â  Â  Â  Â  }

Â  Â  Â  Â  .create-icon-style {
Â  Â  Â  Â  Â  Â  width: 40px;
Â  Â  Â  Â  Â  Â  height: 40px;
Â  Â  Â  Â  Â  Â  background-color: var(--primary-color);
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  Â  Â  border-radius: 50%;
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  justify-content: center;
Â  Â  Â  Â  Â  Â  font-weight: bold;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  border: 2px solid rgba(255, 255, 255, 0.8);
Â  Â  Â  Â  Â  Â  transition: all 0.2s ease;
Â  Â  Â  Â  Â  Â  user-select: none;
Â  Â  Â  Â  Â  Â  margin: 0 auto;
Â  Â  Â  Â  Â  Â  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
Â  Â  Â  Â  }

Â  Â  Â  Â  .create-icon-style:hover {
Â  Â  Â  Â  Â  Â  transform: scale(1.1);
Â  Â  Â  Â  Â  Â  background-color: var(--primary-color);
Â  Â  Â  Â  Â  Â  box-shadow: 0 0 10px var(--primary-color);
Â  Â  Â  Â  }

Â  Â  Â  Â  /* --- GENERAL UI --- */
Â  Â  Â  Â  .card {
Â  Â  Â  Â  Â  Â  background: white;
Â  Â  Â  Â  Â  Â  border: 1px solid var(--border-color);
Â  Â  Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  Â  Â  padding: 20px;
Â  Â  Â  Â  Â  Â  margin-bottom: 15px;
Â  Â  Â  Â  Â  Â  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
Â  Â  Â  Â  }

Â  Â  Â  Â  .card-header {
Â  Â  Â  Â  Â  Â  font-size: 18px;
Â  Â  Â  Â  Â  Â  font-weight: 600;
Â  Â  Â  Â  Â  Â  margin-bottom: 10px;
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  justify-content: space-between;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  }

Â  Â  Â  Â  .card-footer {
Â  Â  Â  Â  Â  Â  margin-top: 15px;
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  gap: 10px;
Â  Â  Â  Â  }

Â  Â  Â  Â  .grid {
Â  Â  Â  Â  Â  Â  display: grid;
Â  Â  Â  Â  Â  Â  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
Â  Â  Â  Â  Â  Â  gap: 20px;
Â  Â  Â  Â  }

Â  Â  Â  Â  .form-group {
Â  Â  Â  Â  Â  Â  margin-bottom: 15px;
Â  Â  Â  Â  }

Â  Â  Â  Â  label {
Â  Â  Â  Â  Â  Â  display: block;
Â  Â  Â  Â  Â  Â  margin-bottom: 5px;
Â  Â  Â  Â  Â  Â  font-weight: 500;
Â  Â  Â  Â  }

Â  Â  Â  Â  input,
Â  Â  Â  Â  textarea,
Â  Â  Â  Â  select {
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  padding: 10px;
Â  Â  Â  Â  Â  Â  border: 1px solid var(--border-color);
Â  Â  Â  Â  Â  Â  border-radius: 4px;
Â  Â  Â  Â  Â  Â  font-size: 14px;
Â  Â  Â  Â  }

Â  Â  Â  Â  .btn {
Â  Â  Â  Â  Â  Â  padding: 8px 16px;
Â  Â  Â  Â  Â  Â  border: none;
Â  Â  Â  Â  Â  Â  border-radius: 4px;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  font-weight: 500;
Â  Â  Â  Â  Â  Â  font-size: 14px;
Â  Â  Â  Â  }

Â  Â  Â  Â  .btn-primary {
Â  Â  Â  Â  Â  Â  background: var(--primary-color);
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  }

Â  Â  Â  Â  .btn-secondary {
Â  Â  Â  Â  Â  Â  background: var(--secondary-color);
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  }

Â  Â  Â  Â  .btn-danger {
Â  Â  Â  Â  Â  Â  background: var(--danger-color);
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  }

Â  Â  Â  Â  .btn-disabled {
Â  Â  Â  Â  Â  Â  background: #ccc;
Â  Â  Â  Â  Â  Â  color: #666;
Â  Â  Â  Â  Â  Â  cursor: not-allowed;
Â  Â  Â  Â  }

Â  Â  Â  Â  .badge {
Â  Â  Â  Â  Â  Â  display: inline-block;
Â  Â  Â  Â  Â  Â  padding: 4px 12px;
Â  Â  Â  Â  Â  Â  border-radius: 20px;
Â  Â  Â  Â  Â  Â  font-size: 12px;
Â  Â  Â  Â  }

Â  Â  Â  Â  .badge-pending {
Â  Â  Â  Â  Â  Â  background: #fff3cd;
Â  Â  Â  Â  Â  Â  color: #856404;
Â  Â  Â  Â  }

Â  Â  Â  Â  .badge-accepted {
Â  Â  Â  Â  Â  Â  background: #d4edda;
Â  Â  Â  Â  Â  Â  color: #155724;
Â  Â  Â  Â  }

Â  Â  Â  Â  .badge-rejected {
Â  Â  Â  Â  Â  Â  background: #f8d7da;
Â  Â  Â  Â  Â  Â  color: #721c24;
Â  Â  Â  Â  }

Â  Â  Â  Â  .badge-verified {
Â  Â  Â  Â  Â  Â  background: #d1ecf1;
Â  Â  Â  Â  Â  Â  color: #0c5460;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* --- MODALS --- */
Â  Â  Â  Â  .modal {
Â  Â  Â  Â  Â  Â  display: none;
Â  Â  Â  Â  Â  Â  position: fixed;
Â  Â  Â  Â  Â  Â  top: 0;
Â  Â  Â  Â  Â  Â  left: 0;
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  height: 100%;
Â  Â  Â  Â  Â  Â  background: rgba(0, 0, 0, 0.5);
Â  Â  Â  Â  Â  Â  z-index: 1000;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  justify-content: center;
Â  Â  Â  Â  }

Â  Â  Â  Â  .modal.active {
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  }

Â  Â  Â  Â  .modal-content {
Â  Â  Â  Â  Â  Â  background: white;
Â  Â  Â  Â  Â  Â  padding: 30px;
Â  Â  Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  Â  Â  max-width: 600px;
Â  Â  Â  Â  Â  Â  width: 90%;
Â  Â  Â  Â  Â  Â  max-height: 90vh;
Â  Â  Â  Â  Â  Â  overflow-y: auto;
Â  Â  Â  Â  }

Â  Â  Â  Â  .modal-header {
Â  Â  Â  Â  Â  Â  font-size: 20px;
Â  Â  Â  Â  Â  Â  font-weight: bold;
Â  Â  Â  Â  Â  Â  margin-bottom: 20px;
Â  Â  Â  Â  }

Â  Â  Â  Â  .modal-footer {
Â  Â  Â  Â  Â  Â  margin-top: 20px;
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  justify-content: flex-end;
Â  Â  Â  Â  Â  Â  gap: 10px;
Â  Â  Â  Â  }

Â  Â  Â  Â  .hidden {
Â  Â  Â  Â  Â  Â  display: none !important;
Â  Â  Â  Â  }

Â  Â  Â  Â  .auth-container {
Â  Â  Â  Â  Â  Â  max-width: 400px;
Â  Â  Â  Â  Â  Â  margin: 50px auto;
Â  Â  Â  Â  Â  Â  background: white;
Â  Â  Â  Â  Â  Â  padding: 30px;
Â  Â  Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  Â  Â  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
Â  Â  Â  Â  }
Â  Â  </style>
</head>

<body>

Â  Â  <div id="authScreen" class="auth-container">
Â  Â  Â  Â  <div id="loginForm">
Â  Â  Â  Â  Â  Â  <h2 style="text-align:center; margin-bottom:20px;">Login</h2>
Â  Â  Â  Â  Â  Â  <p style="text-align:center; color: #666;">(Mock Mode Active - Click Login)</p>
Â  Â  Â  Â  Â  Â  <form onsubmit="handleLogin(event)">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="form-group"><label>Email:</label><input type="email" id="loginEmail" value="mock@vit.com">
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="form-group"><label>Password:</label><input type="password" id="loginPassword"
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  value="password"></div>
Â  Â  Â  Â  Â  Â  Â  Â  <button type="submit" class="btn btn-primary" style="width: 100%;">Login</button>
Â  Â  Â  Â  Â  Â  </form>
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <div id="appScreen" class="hidden">
Â  Â  Â  Â  <div class="container">
Â  Â  Â  Â  Â  Â  <div class="navbar">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="navbar-brand">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h1>VidyaGenie</h1>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p id="userInfo"></p>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="navbar-right">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div id="requestsIcon" onclick="switchTab(event, 'requests')" title="Connection Requests"
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  class="requests-icon-style">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span style="font-size: 20px; position: relative; top: -1px;">ðŸ‘¥</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="profile-circle" id="profileIcon" onclick="switchTab(null, 'profile')"
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  title="My Profile"></div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div class="tabs">
Â  Â  Â  Â  Â  Â  Â  Â  <button class="tab-button" onclick="switchTab(event, 'chats')">Messages</button>
Â  Â  Â  Â  Â  Â  Â  Â  <button class="tab-button" onclick="switchTab(event, 'community')">Community</button>
Â  Â  Â  Â  Â  Â  Â  Â  <button class="tab-button" onclick="switchTab(event, 'mentors')">Explore</button>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div id="mentors" class="tab-content">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="card" style="margin-bottom: 20px;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="card-header">Search Users</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="card-body">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <form id="userSearchForm" onsubmit="handleUserSearch(event)">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="form-group" style="display: flex; gap: 10px;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="text" id="searchInput" placeholder="Search by Name (e.g., Jane)"
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  style="flex-grow: 1;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button type="submit" class="btn btn-primary">Search</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </form>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div id="searchResultsList" class="grid"></div>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div id="requests" class="tab-content">
Â  Â  Â  Â  Â  Â  Â  Â  <div id="requestsList"></div>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div id="chats" class="tab-content">
Â  Â  Â  Â  Â  Â  Â  Â  <div style="display: flex; gap: 20px; height: 70vh;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div id="activeChatsList"
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  style="flex: 0 0 300px; background: white; border: 1px solid var(--border-color); border-radius: 8px; overflow-y: auto;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h4 style="padding: 15px; border-bottom: 1px solid var(--border-color);">Active Conversations
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </h4>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div id="chatsListContent">Loading...</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div id="messageView"
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  style="flex: 1; background: white; border: 1px solid var(--border-color); border-radius: 8px; display: flex; flex-direction: column;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div id="chatHeader"
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  style="padding: 15px; border-bottom: 1px solid var(--border-color); font-weight: bold;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Select a chat to begin.</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div id="messagesContainer" style="flex: 1; overflow-y: auto; padding: 20px;"></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <form id="sendMessageForm" onsubmit="handleSendMessage(event)" class="hidden"
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  style="padding: 15px; border-top: 1px solid var(--border-color); display: flex; gap: 10px;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="hidden" id="selectedChatId">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <textarea id="messageText" placeholder="Type your message..." required
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  style="flex-grow: 1; resize: none; height: 40px;"></textarea>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button type="submit" class="btn btn-primary">Send</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </form>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div id="community" class="tab-content">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="center-icon-wrapper">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div id="createPostIcon" class="create-icon-style" onclick="openCreatePostModal()"
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  title="Create New Post">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span style="font-size: 24px; position: relative; top: -2px;">+</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div id="communityPostsList" style="margin-top: 20px; padding: 0 10px;"></div>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div id="profile" class="tab-content">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="card">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="card-header">My Profile</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div id="profileContent" class="card-body"></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="card-footer">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="btn btn-danger" onclick="window.location.reload()">Logout</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <div id="createPostModal" class="modal">
Â  Â  Â  Â  <div class="modal-content">
Â  Â  Â  Â  Â  Â  <div class="modal-header">Create Discussion Post</div>
Â  Â  Â  Â  Â  Â  <form onsubmit="handleCreatePostSubmit(event)">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="form-group">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label>Title:</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="text" id="communityPostTitle" required>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="form-group">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label>Details:</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <textarea id="communityPostBody" required></textarea>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="modal-footer">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button type="button" class="btn"
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  onclick="document.getElementById('createPostModal').classList.remove('active')">Cancel</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button type="submit" class="btn btn-primary">Post</button>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </form>
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <div id="postDetailModal" class="modal">
Â  Â  Â  Â  <div class="modal-content">
Â  Â  Â  Â  Â  Â  <div class="modal-header" id="postDetailTitle">Post Title</div>
Â  Â  Â  Â  Â  Â  <div id="postDetailBody" style="margin-bottom: 20px; padding-bottom: 10px; border-bottom: 1px solid #ddd;">
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <h4 style="margin-bottom: 10px;">Discussion</h4>
Â  Â  Â  Â  Â  Â  <div id="commentsList" style="max-height: 300px; overflow-y: auto; margin-bottom: 15px;"></div>
Â  Â  Â  Â  Â  Â  <form onsubmit="handleNewComment(event)">
Â  Â  Â  Â  Â  Â  Â  Â  <input type="hidden" id="currentPostId">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="form-group">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <textarea id="commentText" placeholder="Add a comment..." required></textarea>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="modal-footer" style="justify-content: space-between;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button type="button" class="btn"
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  onclick="document.getElementById('postDetailModal').classList.remove('active')">Close</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button type="submit" class="btn btn-primary">Comment</button>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </form>
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
Â  Â  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
Â  Â  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>

Â  Â  <script>
Â  Â  Â  Â  const firebaseConfig = {
Â  Â  Â  Â  Â  Â  apiKey: "AIzaSyBFivNpSRGK87SDxzi3wWJAl3Pia_vrezo",
Â  Â  Â  Â  Â  Â  authDomain: "college-mentorship--app.firebaseapp.com",
Â  Â  Â  Â  Â  Â  projectId: "college-mentorship--app",
Â  Â  Â  Â  Â  Â  storageBucket: "college-mentorship--app.firebasestorage.app",
Â  Â  Â  Â  Â  Â  messagingSenderId: "842851012332",
Â  Â  Â  Â  Â  Â  appId: "1:842851012332:web:37ff1cbf9b7b90977c1fc9",
Â  Â  Â  Â  Â  Â  measurementId: "G-G6MN80S4LM"
Â  Â  Â  Â  };

Â  Â  Â  Â  let app, auth, db, currentUser, currentUserData;

Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  app = firebase.initializeApp(firebaseConfig);
Â  Â  Â  Â  Â  Â  auth = firebase.auth();
Â  Â  Â  Â  Â  Â  db = firebase.firestore();
Â  Â  Â  Â  Â  Â  console.log("Firebase initialized");
Â  Â  Â  Â  } catch (error) { console.error(error); }

Â  Â  Â  Â  // --- TEMPORARY LOGIN BYPASS (Multi-User Switcher) ---

Â  Â  Â  Â  // ðŸŸ¢ STEP 1: UNCOMMENT THE ID OF THE USER YOU WANT TO BE:

Â  Â  Â  Â  //const MOCK_USER_ID = "rZTJaAZXbVml1SpAzsdz"; // SELVA (MENTOR)
Â  Â  Â  Â  const MOCK_USER_ID = "4UvojVrHYVFBiOtRbHoD"; // SIDDHANT (STUDENT)

Â  Â  Â  Â  // ---------------------------------------------------------

Â  Â  Â  Â  currentUser = { uid: MOCK_USER_ID };

Â  Â  Â  Â  const MOCK_USERS = {
Â  Â  Â  Â  Â  Â  "rZTJaAZXbVml1SpAzsdz": {
Â  Â  Â  Â  Â  Â  Â  Â  userId: "rZTJaAZXbVml1SpAzsdz",
Â  Â  Â  Â  Â  Â  Â  Â  name: "selva",
Â  Â  Â  Â  Â  Â  Â  Â  email: "selva@vit.com",
Â  Â  Â  Â  Â  Â  Â  Â  role: "mentor",
Â  Â  Â  Â  Â  Â  Â  Â  college: "VIT",
Â  Â  Â  Â  Â  Â  Â  Â  year: "3rd Year",
Â  Â  Â  Â  Â  Â  Â  Â  isVerified: true
Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  "4UvojVrHYVFBiOtRbHoD": {
Â  Â  Â  Â  Â  Â  Â  Â  userId: "4UvojVrHYVFBiOtRbHoD",
Â  Â  Â  Â  Â  Â  Â  Â  name: "prajwal",
Â  Â  Â  Â  Â  Â  Â  Â  email: "jane@college.com",
Â  Â  Â  Â  Â  Â  Â  Â  role: "student",
Â  Â  Â  Â  Â  Â  Â  Â  college: "Vidyalankar Poly",
Â  Â  Â  Â  Â  Â  Â  Â  bio: "CSE Alumni, Expert in Web Development",
Â  Â  Â  Â  Â  Â  Â  Â  expertise: ["React", "Firebase"],
Â  Â  Â  Â  Â  Â  Â  Â  isVerified: true
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  };

Â  Â  Â  Â  // ðŸŸ¢ STEP 3: AUTOMATICALLY SELECT DATA
Â  Â  Â  Â  currentUserData = MOCK_USERS[MOCK_USER_ID];

Â  Â  Â  Â  // Force App Start
Â  Â  Â  Â  document.getElementById('authScreen').classList.add('hidden');
Â  Â  Â  Â  document.getElementById('appScreen').classList.remove('hidden');
Â  Â  Â  Â  updateUserInfo();

Â  Â  Â  Â  // Start on Requests Tab (Convenient for testing invites)
Â  Â  Â  Â  // Start on Community Tab (Requested Default View)
Â  Â  Â  Â  // Find the button elements for the Community tab and manually activate them
Â  Â  Â  Â  const communityButton = document.querySelector('.tabs button:nth-child(3)'); // Assuming Community is the 3rd button
Â  Â  Â  Â  if (communityButton) {
Â  Â  Â  Â  Â  Â  communityButton.classList.add('active');
Â  Â  Â  Â  }
Â  Â  Â  Â  switchTab(null, 'community'); // This loads the content panel

Â  Â  Â  Â  function updateUserInfo() {
Â  Â  Â  Â  Â  Â  if (currentUserData) {
Â  Â  Â  Â  Â  Â  Â  Â  // Capitalize name for display
Â  Â  Â  Â  Â  Â  Â  Â  const displayName = currentUserData.name.charAt(0).toUpperCase() + currentUserData.name.slice(1);
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('userInfo').textContent = `${displayName} (${currentUserData.role.toUpperCase()})`;
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('profileIcon').textContent = displayName.charAt(0);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  // --- NAVIGATION ---
Â  Â  Â  Â  function switchTab(event, tabName) {
Â  Â  Â  Â  Â  Â  document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
Â  Â  Â  Â  Â  Â  document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
Â  Â  Â  Â  Â  Â  document.getElementById(tabName).classList.add('active');
Â  Â  Â  Â  Â  Â  if (event && event.currentTarget) event.currentTarget.classList.add('active');

Â  Â  Â  Â  Â  Â  if (tabName === 'mentors') loadMentors();
Â  Â  Â  Â  Â  Â  if (tabName === 'requests') loadRequests();
Â  Â  Â  Â  Â  Â  if (tabName === 'chats') loadChats();
Â  Â  Â  Â  Â  Â  if (tabName === 'community') loadCommunity();
Â  Â  Â  Â  Â  Â  if (tabName === 'profile') loadProfile();
Â  Â  Â  Â  }

Â  Â  Â  Â  // --- SEARCH & CONNECTIONS (Mentors Tab) ---
Â  Â  Â  Â  // --- SEARCH & CONNECTIONS (Mentors Tab) ---
Â  Â  Â  Â  // --- SEARCH & CONNECTIONS (Mentors Tab) ---
Â  Â  Â  Â  function loadMentors() {
Â  Â  Â  Â  Â  Â  const listEl = document.getElementById('searchResultsList');
Â  Â  Â  Â  Â  Â  listEl.innerHTML = '<p style="text-align: center; grid-column: 1 / -1;">Loading user and connection data...</p>';

Â  Â  Â  Â  Â  Â  // 1. Fetch all users
Â  Â  Â  Â  Â  Â  const usersPromise = db.collection('users').get();

Â  Â  Â  Â  Â  Â  // 2. Fetch all requests involving the current user (requires OR query setup)
Â  Â  Â  Â  Â  Â  // Firestore doesn't support 'OR' easily, so we query based on our user ID being in 'participants' array.
Â  Â  Â  Â  Â  Â  // NOTE: This query requires the existing 'participants' array index on the 'connection_requests' collection.
Â  Â  Â  Â  Â  Â  const requestsPromise = db.collection('connection_requests')
Â  Â  Â  Â  Â  Â  Â  Â  .where('recipientId', '==', currentUser.uid)
Â  Â  Â  Â  Â  Â  Â  Â  .get();

Â  Â  Â  Â  Â  Â  // For the Sender side, we must also fetch requests *sent by* the current user
Â  Â  Â  Â  Â  Â  const sentRequestsPromise = db.collection('connection_requests')
Â  Â  Â  Â  Â  Â  Â  Â  .where('senderId', '==', currentUser.uid)
Â  Â  Â  Â  Â  Â  Â  Â  .get();

Â  Â  Â  Â  Â  Â  // Wait for all data to load
Â  Â  Â  Â  Â  Â  Promise.all([usersPromise, requestsPromise, sentRequestsPromise]).then(([userSnap, receivedReqSnap, sentReqSnap]) => {
Â  Â  Â  Â  Â  Â  Â  Â  const allRequests = [...receivedReqSnap.docs, ...sentReqSnap.docs];
Â  Â  Â  Â  Â  Â  Â  Â  renderUserResults(userSnap, allRequests);
Â  Â  Â  Â  Â  Â  }).catch(e => {
Â  Â  Â  Â  Â  Â  Â  Â  listEl.innerHTML = '<p style="color:red; text-align:center;">Failed to load connections. Check console (Index required).</p>';
Â  Â  Â  Â  Â  Â  Â  Â  console.error("Error in loadMentors:", e);
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  }
Â  Â  Â  Â  function handleUserSearch(event) {
Â  Â  Â  Â  Â  Â  event.preventDefault();
Â  Â  Â  Â  Â  Â  const term = document.getElementById('searchInput').value.toLowerCase().trim();
Â  Â  Â  Â  Â  Â  if (!term) return loadMentors(); // Reset if empty

Â  Â  Â  Â  Â  Â  const listEl = document.getElementById('searchResultsList');
Â  Â  Â  Â  Â  Â  listEl.innerHTML = 'Searching...';

Â  Â  Â  Â  Â  Â  const end = term.replace(/.$/, c => String.fromCharCode(c.charCodeAt(0) + 1));

Â  Â  Â  Â  Â  Â  db.collection('users')
Â  Â  Â  Â  Â  Â  Â  Â  .where('name', '>=', term)
Â  Â  Â  Â  Â  Â  Â  Â  .where('name', '<', end)
Â  Â  Â  Â  Â  Â  Â  Â  .get()
Â  Â  Â  Â  Â  Â  Â  Â  .then(renderUserResults)
Â  Â  Â  Â  Â  Â  Â  Â  .catch(e => console.error(e));
Â  Â  Â  Â  }

Â  Â  Â  Â  function renderUserResults(userSnapshot, allRequests) {
Â  Â  Â  Â  Â  Â  const listEl = document.getElementById('searchResultsList');
Â  Â  Â  Â  Â  Â  let html = '';

Â  Â  Â  Â  Â  Â  userSnapshot.forEach(doc => {
Â  Â  Â  Â  Â  Â  Â  Â  const user = doc.data();
Â  Â  Â  Â  Â  Â  Â  Â  const targetUserId = doc.id;

Â  Â  Â  Â  Â  Â  Â  Â  // 1. Skip if user is invalid or is the current logged-in user
Â  Â  Â  Â  Â  Â  Â  Â  if (!user || targetUserId === currentUser.uid) return;

Â  Â  Â  Â  Â  Â  Â  Â  // --- Client-Side Connection Check (The Fix) ---
Â  Â  Â  Â  Â  Â  Â  Â  const existingRequest = allRequests.find(reqDoc => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const data = reqDoc.data();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Check if the request involves BOTH the current user AND the target user
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  return (data.senderId === currentUser.uid && data.recipientId === targetUserId) ||
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  (data.senderId === targetUserId && data.recipientId === currentUser.uid);
Â  Â  Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  Â  Â  let buttonHtml;

Â  Â  Â  Â  Â  Â  Â  Â  if (existingRequest) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const status = existingRequest.data().status;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const statusText = status === 'accepted' ? 'Connected' : 'Requested';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const btnClass = status === 'accepted' ? 'btn-secondary' : 'btn-disabled';

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  buttonHtml = `<button class="btn ${btnClass}" disabled>${statusText}</button>`;
Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const name = user.name || 'Unknown';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  buttonHtml = `<button class="btn btn-primary" id="btn-${targetUserId}" onclick="sendInstantConnectionRequest('${targetUserId}', '${name}', this)">Connect</button>`;
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  // --- End Connection Check ---

Â  Â  Â  Â  Â  Â  Â  Â  // Safe Name, Role, and Detail Formatting
Â  Â  Â  Â  Â  Â  Â  Â  const name = user.name || 'Unknown';
Â  Â  Â  Â  Â  Â  Â  Â  const displayName = name.charAt(0).toUpperCase() + name.slice(1);
Â  Â  Â  Â  Â  Â  Â  Â  const roleText = (user.role || 'N/A').toUpperCase();
Â  Â  Â  Â  Â  Â  Â  Â  const details = (user.role === 'mentor')
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ? `Expertise: ${(user.expertise || []).join(', ')}`
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  : `Year: ${user.year || 'N/A'}`;

Â  Â  Â  Â  Â  Â  Â  Â  html += `
Â  Â  Â  Â  Â  Â  <div class="card">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="card-header">${displayName} <span class="badge badge-verified">${roleText}</span></div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="card-body">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p><strong>College:</strong> ${user.college || 'N/A'}</p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p><strong>Details:</strong> ${details}</p>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="card-footer" style="gap: 10px;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ${buttonHtml}
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>`;
Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  listEl.innerHTML = html || '<p style="text-align:center; grid-column: 1/-1;">No users found.</p>';
Â  Â  Â  Â  }
Â  Â  Â  Â  // --- INSTANT CONNECTION REQUEST (Instagram Style) ---
Â  Â  Â  Â  function sendInstantConnectionRequest(recipientId, recipientName, btnElement) {
Â  Â  Â  Â  Â  Â  // Disable button immediately to prevent double clicks
Â  Â  Â  Â  Â  Â  btnElement.disabled = true;
Â  Â  Â  Â  Â  Â  btnElement.textContent = "Sending...";

Â  Â  Â  Â  Â  Â  db.collection('connection_requests').add({
Â  Â  Â  Â  Â  Â  Â  Â  senderId: currentUser.uid,
Â  Â  Â  Â  Â  Â  Â  Â  senderName: currentUserData.name,
Â  Â  Â  Â  Â  Â  Â  Â  recipientId: recipientId,
Â  Â  Â  Â  Â  Â  Â  Â  recipientName: recipientName,
Â  Â  Â  Â  Â  Â  Â  Â  status: 'pending',
Â  Â  Â  Â  Â  Â  Â  Â  subject: 'General Connection', // Default subject
Â  Â  Â  Â  Â  Â  Â  Â  message: "I'd like to connect with you on VidyaGenie!", // Default message
Â  Â  Â  Â  Â  Â  Â  Â  createdAt: new Date()
Â  Â  Â  Â  Â  Â  }).then(() => {
Â  Â  Â  Â  Â  Â  Â  Â  // Update button UI to show success state
Â  Â  Â  Â  Â  Â  Â  Â  btnElement.textContent = "Requested";
Â  Â  Â  Â  Â  Â  Â  Â  btnElement.classList.remove('btn-primary');
Â  Â  Â  Â  Â  Â  Â  Â  btnElement.classList.add('btn-secondary'); // Change color
Â  Â  Â  Â  Â  Â  Â  Â  btnElement.style.cursor = "default";
Â  Â  Â  Â  Â  Â  }).catch(error => {
Â  Â  Â  Â  Â  Â  Â  Â  console.error("Error sending request:", error);
Â  Â  Â  Â  Â  Â  Â  Â  alert("Failed to send request.");
Â  Â  Â  Â  Â  Â  Â  Â  btnElement.disabled = false;
Â  Â  Â  Â  Â  Â  Â  Â  btnElement.textContent = "Connect";
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  }

Â  Â  Â  Â  // --- REQUESTS TAB ---
Â  Â  Â  Â  function loadRequests() {
Â  Â  Â  Â  Â  Â  const list = document.getElementById('requestsList');
Â  Â  Â  Â  Â  Â  list.innerHTML = 'Loading...';
Â  Â  Â  Â  Â  Â  // Find requests where I am the recipient
Â  Â  Â  Â  Â  Â  db.collection('connection_requests').where('recipientId', '==', currentUser.uid).get().then(snap => {
Â  Â  Â  Â  Â  Â  Â  Â  let html = '';
Â  Â  Â  Â  Â  Â  Â  Â  snap.forEach(doc => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const req = doc.data();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  html += `
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="card">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="card-header">From: ${req.senderName} <span class="badge badge-${req.status}">${req.status}</span></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="card-body"><p>${req.message}</p></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ${req.status === 'pending' ? `
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="card-footer">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="btn btn-secondary" onclick="updateRequest('${doc.id}', 'accepted', '${req.senderId}')">Accept</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="btn btn-danger" onclick="updateRequest('${doc.id}', 'rejected')">Reject</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>` : ''}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>`;
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  list.innerHTML = html || '<p>No pending requests.</p>';
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  }

Â  Â  Â  Â  function updateRequest(id, status, otherId) {
Â  Â  Â  Â  Â  Â  db.collection('connection_requests').doc(id).update({ status }).then(() => {
Â  Â  Â  Â  Â  Â  Â  Â  if (status === 'accepted') createChat(otherId);
Â  Â  Â  Â  Â  Â  Â  Â  loadRequests();
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  }

Â  Â  Â  Â  // --- CHATS ---
Â  Â  Â  Â  function createChat(otherId) {
Â  Â  Â  Â  Â  Â  const chatId = [currentUser.uid, otherId].sort().join('_');
Â  Â  Â  Â  Â  Â  db.collection('chats').doc(chatId).set({
Â  Â  Â  Â  Â  Â  Â  Â  participants: [currentUser.uid, otherId],
Â  Â  Â  Â  Â  Â  Â  Â  lastMessage: 'Chat started',
Â  Â  Â  Â  Â  Â  Â  Â  updatedAt: new Date()
Â  Â  Â  Â  Â  Â  }, { merge: true });
Â  Â  Â  Â  }

Â  Â  Â  Â  function loadChats() {
Â  Â  Â  Â  Â  Â  const listEl = document.getElementById('chatsListContent');
Â  Â  Â  Â  Â  Â  listEl.innerHTML = 'Loading chats...';
Â  Â  Â  Â  Â  Â  db.collection('chats').where('participants', 'array-contains', currentUser.uid)
Â  Â  Â  Â  Â  Â  Â  Â  .orderBy('updatedAt', 'desc').get().then(async snap => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  let html = '';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  for (const doc of snap.docs) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const chat = doc.data();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const otherId = chat.participants.find(id => id !== currentUser.uid);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const userSnap = await db.collection('users').doc(otherId).get();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const otherName = userSnap.exists ? userSnap.data().name : 'Unknown';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const role = userSnap.exists ? (userSnap.data().role || '').toUpperCase() : '';

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // UPDATED HTML: Added flex display and the delete button
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  html += `
Â  Â  Â  Â  Â  Â  Â  Â  <div class="card chat-item" onclick="openInlineChat('${doc.id}', '${otherName}')" style="cursor:pointer; padding: 10px; margin-bottom: 5px; display: flex; justify-content: space-between; align-items: center;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style="font-weight: 600;">${otherName} (${role})</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <small style="color: #777;">${chat.lastMessage}</small>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="btn btn-danger" style="padding: 2px 8px; font-size: 12px;" onclick="deleteChat('${doc.id}', event)">X</button>
Â  Â  Â  Â  Â  Â  Â  Â  </div>`;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  listEl.innerHTML = html || 'No active chats.';
Â  Â  Â  Â  Â  Â  Â  Â  }).catch(e => { console.error(e); listEl.innerHTML = '<p style="color:red">Error loading chats. (Requires Index)</p>'; });
Â  Â  Â  Â  }
Â  Â  Â  Â  function deleteChat(chatId, event) {
Â  Â  Â  Â  Â  Â  // Critical: Stop the click from bubbling up to the card and opening the chat
Â  Â  Â  Â  Â  Â  event.stopPropagation();

Â  Â  Â  Â  Â  Â  if (confirm("Are you sure you want to delete this conversation?")) {
Â  Â  Â  Â  Â  Â  Â  Â  db.collection('chats').doc(chatId).delete().then(() => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Refresh the list
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  loadChats();

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // If the user currently has this specific chat open, clear the view
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (document.getElementById('selectedChatId').value === chatId) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('chatHeader').textContent = "Select a chat to begin.";
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('messagesContainer').innerHTML = "";
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('sendMessageForm').classList.add('hidden');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  }).catch(error => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  console.error("Error deleting chat:", error);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  alert("Failed to delete chat.");
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  let msgUnsub;
Â  Â  Â  Â  function openInlineChat(chatId, name) {
Â  Â  Â  Â  Â  Â  if (msgUnsub) msgUnsub();
Â  Â  Â  Â  Â  Â  document.getElementById('selectedChatId').value = chatId;
Â  Â  Â  Â  Â  Â  document.getElementById('chatHeader').textContent = name;
Â  Â  Â  Â  Â  Â  document.getElementById('sendMessageForm').classList.remove('hidden');
Â  Â  Â  Â  Â  Â  const container = document.getElementById('messagesContainer');

Â  Â  Â  Â  Â  Â  msgUnsub = db.collection('chats').doc(chatId).collection('messages').orderBy('timestamp', 'asc')
Â  Â  Â  Â  Â  Â  Â  Â  .onSnapshot(snap => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  let html = '';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  snap.forEach(doc => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const m = doc.data();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const isMe = m.senderId === currentUser.uid;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  html += `<div style="text-align: ${isMe ? 'right' : 'left'}; margin: 5px 0;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span style="background: ${isMe ? '#2196F3' : '#eee'}; color: ${isMe ? 'white' : 'black'}; padding: 5px 10px; border-radius: 10px; display:inline-block;">${m.text}</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>`;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  container.innerHTML = html;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  container.scrollTop = container.scrollHeight;
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  }

Â  Â  Â  Â  function handleSendMessage(e) {
Â  Â  Â  Â  Â  Â  e.preventDefault();
Â  Â  Â  Â  Â  Â  const text = document.getElementById('messageText').value.trim();
Â  Â  Â  Â  Â  Â  const chatId = document.getElementById('selectedChatId').value;
Â  Â  Â  Â  Â  Â  if (!text) return;

Â  Â  Â  Â  Â  Â  db.collection('chats').doc(chatId).collection('messages').add({
Â  Â  Â  Â  Â  Â  Â  Â  text, senderId: currentUser.uid, timestamp: new Date()
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  db.collection('chats').doc(chatId).update({ lastMessage: text, updatedAt: new Date() });
Â  Â  Â  Â  Â  Â  document.getElementById('messageText').value = '';
Â  Â  Â  Â  }

Â  Â  Â  Â  // --- COMMUNITY & COMMENTS ---
Â  Â  Â  Â  function loadCommunity() {
Â  Â  Â  Â  Â  Â  db.collection('posts').orderBy('createdAt', 'desc').limit(20).get().then(snap => {
Â  Â  Â  Â  Â  Â  Â  Â  let html = '';
Â  Â  Â  Â  Â  Â  Â  Â  snap.forEach(doc => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const p = doc.data();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const isAuthor = p.authorId === currentUser.uid;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  html += `
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="card">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style="cursor:pointer;" onclick="viewPost('${doc.id}')">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="card-header">${p.title} <span class="badge badge-verified">${p.authorRole}</span></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="card-body">${p.body}</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="card-footer" style="justify-content: space-between;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <small>By ${p.authorName}</small>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style="display:flex; gap:10px;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="btn btn-secondary" onclick="viewPost('${doc.id}')">Comment</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ${isAuthor ? `<button class="btn btn-danger" onclick="deletePost('${doc.id}')">Delete</button>` : ''}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="btn btn-secondary" onclick="upvote('${doc.id}')">Upvote (${p.upvotes || 0})</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>`;
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('communityPostsList').innerHTML = html || 'No posts.';
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  }

Â  Â  Â  Â  function openCreatePostModal() { document.getElementById('createPostModal').classList.add('active'); }

Â  Â  Â  Â  function handleCreatePostSubmit(e) {
Â  Â  Â  Â  Â  Â  e.preventDefault();
Â  Â  Â  Â  Â  Â  const title = document.getElementById('communityPostTitle').value;
Â  Â  Â  Â  Â  Â  const body = document.getElementById('communityPostBody').value;
Â  Â  Â  Â  Â  Â  db.collection('posts').add({
Â  Â  Â  Â  Â  Â  Â  Â  title, body, authorId: currentUser.uid, authorName: currentUserData.name, authorRole: currentUserData.role,
Â  Â  Â  Â  Â  Â  Â  Â  upvotes: 0, upvoters: [], createdAt: new Date()
Â  Â  Â  Â  Â  Â  }).then(() => {
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('createPostModal').classList.remove('active');
Â  Â  Â  Â  Â  Â  Â  Â  loadCommunity();
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  }

Â  Â  Â  Â  function deletePost(id) {
Â  Â  Â  Â  Â  Â  if (confirm("Delete post?")) db.collection('posts').doc(id).delete().then(loadCommunity);
Â  Â  Â  Â  }

Â  Â  Â  Â  // --- NEW POST/COMMENT VIEW ---
Â  Â  Â  Â  function viewPost(id) {
Â  Â  Â  Â  Â  Â  document.getElementById('currentPostId').value = id;
Â  Â  Â  Â  Â  Â  db.collection('posts').doc(id).get().then(doc => {
Â  Â  Â  Â  Â  Â  Â  Â  const p = doc.data();
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('postDetailTitle').textContent = p.title;
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('postDetailBody').innerHTML = `<p>${p.body}</p><small>By ${p.authorName}</small>`;
Â  Â  Â  Â  Â  Â  Â  Â  loadComments(id);
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('postDetailModal').classList.add('active');
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  }

Â  Â  Â  Â  function loadComments(postId) {
Â  Â  Â  Â  Â  Â  const list = document.getElementById('commentsList');
Â  Â  Â  Â  Â  Â  list.innerHTML = 'Loading...';
Â  Â  Â  Â  Â  Â  // Sort by Upvotes DESC, then Timestamp DESC (Needs Index, fallback to simple query if fails)
Â  Â  Â  Â  Â  Â  db.collection('posts').doc(postId).collection('comments')
Â  Â  Â  Â  Â  Â  Â  Â  .orderBy('upvotes', 'desc').orderBy('timestamp', 'desc')
Â  Â  Â  Â  Â  Â  Â  Â  .get().then(snap => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  renderComments(snap, list, postId);
Â  Â  Â  Â  Â  Â  Â  Â  })
Â  Â  Â  Â  Â  Â  Â  Â  .catch(err => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  console.log("Index missing, falling back to timestamp sort.");
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  db.collection('posts').doc(postId).collection('comments').orderBy('timestamp', 'desc').get()
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  .then(snap => renderComments(snap, list, postId));
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  }

Â  Â  Â  Â  function renderComments(snap, list, postId) {
Â  Â  Â  Â  Â  Â  let html = '';
Â  Â  Â  Â  Â  Â  snap.forEach(doc => {
Â  Â  Â  Â  Â  Â  Â  Â  const c = doc.data();
Â  Â  Â  Â  Â  Â  Â  Â  const isAuthor = c.authorId === currentUser.uid;
Â  Â  Â  Â  Â  Â  Â  Â  html += `
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style="border:1px solid #eee; padding:10px; margin-bottom:5px; border-radius:5px; background:#fafafa;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p>${c.text}</p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style="display:flex; justify-content:space-between; align-items:center; font-size:12px; margin-top:5px;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span style="color:#666">${c.authorName}</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style="display:flex; gap:5px;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ${!isAuthor ? `<button class="btn btn-secondary" style="padding:2px 6px; font-size:10px;" onclick="upvoteComment('${postId}', '${doc.id}')">Upvote (${c.upvotes || 0})</button>` : `<span style="padding:2px 6px;">Upvotes: ${c.upvotes || 0}</span>`}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ${isAuthor ? `<button class="btn btn-danger" style="padding:2px 6px; font-size:10px;" onclick="deleteComment('${postId}', '${doc.id}')">Delete</button>` : ''}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>`;
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  list.innerHTML = html || 'No comments.';
Â  Â  Â  Â  }

Â  Â  Â  Â  function handleNewComment(e) {
Â  Â  Â  Â  Â  Â  e.preventDefault();
Â  Â  Â  Â  Â  Â  const text = document.getElementById('commentText').value;
Â  Â  Â  Â  Â  Â  const pid = document.getElementById('currentPostId').value;
Â  Â  Â  Â  Â  Â  db.collection('posts').doc(pid).collection('comments').add({
Â  Â  Â  Â  Â  Â  Â  Â  text, authorId: currentUser.uid, authorName: currentUserData.name, authorRole: currentUserData.role,
Â  Â  Â  Â  Â  Â  Â  Â  timestamp: new Date(), upvotes: 0, upvoters: []
Â  Â  Â  Â  Â  Â  }).then(() => {
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('commentText').value = '';
Â  Â  Â  Â  Â  Â  Â  Â  loadComments(pid);
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  }

Â  Â  Â  Â  function deleteComment(pid, cid) {
Â  Â  Â  Â  Â  Â  if (confirm("Delete comment?")) db.collection('posts').doc(pid).collection('comments').doc(cid).delete().then(() => loadComments(pid));
Â  Â  Â  Â  }

Â  Â  Â  Â  function upvote(id) {
Â  Â  Â  Â  Â  Â  // Post Upvote logic remains same
Â  Â  Â  Â  Â  Â  const ref = db.collection('posts').doc(id);
Â  Â  Â  Â  Â  Â  ref.get().then(doc => {
Â  Â  Â  Â  Â  Â  Â  Â  if (doc.data().authorId === currentUser.uid) return alert("Cannot upvote self");
Â  Â  Â  Â  Â  Â  Â  Â  const upvoters = doc.data().upvoters || [];
Â  Â  Â  Â  Â  Â  Â  Â  const hasUpvoted = upvoters.includes(currentUser.uid);
Â  Â  Â  Â  Â  Â  Â  Â  ref.update({
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  upvotes: firebase.firestore.FieldValue.increment(hasUpvoted ? -1 : 1),
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  upvoters: hasUpvoted ? upvoters.filter(x => x !== currentUser.uid) : [...upvoters, currentUser.uid]
Â  Â  Â  Â  Â  Â  Â  Â  }).then(loadCommunity);
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  }

Â  Â  Â  Â  function upvoteComment(pid, cid) {
Â  Â  Â  Â  Â  Â  const ref = db.collection('posts').doc(pid).collection('comments').doc(cid);
Â  Â  Â  Â  Â  Â  ref.get().then(doc => {
Â  Â  Â  Â  Â  Â  Â  Â  const data = doc.data();
Â  Â  Â  Â  Â  Â  Â  Â  if (data.authorId === currentUser.uid) return; // Safety check
Â  Â  Â  Â  Â  Â  Â  Â  const upvoters = data.upvoters || [];
Â  Â  Â  Â  Â  Â  Â  Â  const hasUpvoted = upvoters.includes(currentUser.uid);
Â  Â  Â  Â  Â  Â  Â  Â  ref.update({
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  upvotes: firebase.firestore.FieldValue.increment(hasUpvoted ? -1 : 1),
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  upvoters: hasUpvoted ? upvoters.filter(id => id !== currentUser.uid) : [...upvoters, currentUser.uid]
Â  Â  Â  Â  Â  Â  Â  Â  }).then(() => loadComments(pid));
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  }

Â  Â  Â  Â  // --- PROFILE ---
Â  Â  Â  Â  // --- PROFILE ---
Â  Â  Â  Â  function loadProfile() {
Â  Â  Â  Â  Â  Â  const p = document.getElementById('profileContent');

Â  Â  Â  Â  Â  Â  // formatting name
Â  Â  Â  Â  Â  Â  const displayName = currentUserData.name.charAt(0).toUpperCase() + currentUserData.name.slice(1);
Â  Â  Â  Â  Â  Â  const displayIcon = displayName.charAt(0);

Â  Â  Â  Â  Â  Â  p.innerHTML = `
Â  Â  Â  Â  Â  Â  Â  Â  <div style="display: flex; flex-direction: column; align-items: center; margin-bottom: 20px;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style="width: 80px; height: 80px; background: var(--primary-color); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 32px; font-weight: bold; margin-bottom: 10px; box-shadow: 0 4px 8px rgba(0,0,0,0.1);">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ${displayIcon}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h2 style="margin: 0;">${displayName}</h2>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="badge badge-verified" style="margin-top: 5px;">${currentUserData.role.toUpperCase()}</span>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  <div style="background: #fff; padding: 20px; border-radius: 8px; border: 1px solid #eee;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p style="margin-bottom: 10px; font-size: 16px;"><strong>ðŸ“§ Email:</strong> ${currentUserData.email}</p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p style="margin-bottom: 10px; font-size: 16px;"><strong>ðŸŽ“ College:</strong> ${currentUserData.college}</p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p style="margin-bottom: 10px; font-size: 16px;"><strong>ðŸ“… Year:</strong> ${currentUserData.year}</p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  `;
Â  Â  Â  Â  }
Â  Â  Â  Â  function handleLogin(e) { e.preventDefault(); alert("Mock Login Successful"); }
Â  Â  </script>
</body>

</html>


now we need to beautify the website. make it professional, smooth and fluid. use dark theme (gray or black) . Use professional and solid colours. Change the font to a premium one ( apple font) Give fluid animations to each button, hover, textbox, nothing should be laggy or jagged. It should feel rich, premium and luxurious to use the website. The community tab shuold be pretty and interactive. Make the title more appealing, You can use whatever font you like, you can take inspiration from Twitter or Apple. No gradients only solid colours. DO NOT CHANGE BACKEND ONLY MAKE CHANGES IN CSS AND FRONTEND DO NOT CHANGE JAVASCRIPT OR ANYTHING LOGICAL